jQuery(document).ready(function(){'use strict';jQuery(document).on('click','.close-mini-vid',function(){jQuery('.player-minimize').addClass('revert-minivid');});jQuery(document).on('click','.autoplay-option',function(){var type=jQuery(this).attr('type');jQuery('.autoplay-option').removeClass('selected-option');jQuery(this).addClass('selected-option');if(type==='true'){jwplayer('myVidShortcode').play(true);}else{jwplayer('myVidShortcode').play(false);}
jQuery.cookie('shortcodeAutoPlay',type,{expires:30});});jQuery(document).ready(setTimeout(function(){var autoplayOption=jQuery.cookie('shortcodeAutoPlay');var videoTop=jQuery('.shortcode-video').attr('vid-top');if('true'===videoTop){var videoElement=document.querySelector('.video-player-container');jQuery('.video-player-container').remove();jQuery('article.post header h1').after(videoElement);}
if('false'!==autoplayOption){jQuery('.autoplay-option:contains("On")').addClass('selected-option');startPlayingVideo(true);}else{jQuery('.autoplay-option:contains("Off")').addClass('selected-option');startPlayingVideo(false);}
function getElementOffsetTop(el){var boundingClientRect=el.getBoundingClientRect();var bodyEl=document.body;var docEl=document.documentElement;var scrollTop=window.pageYOffset||docEl.scrollTop||bodyEl.scrollTop;var clientTop=docEl.clientTop||bodyEl.clientTop||0;return Math.round(boundingClientRect.top+ scrollTop- clientTop);}
function getScrollTop(){var docEl=document.documentElement;return(window.pageYOffset||docEl.scrollTop)-(docEl.clientTop||0);}
function startPlayingVideo(autoStartVid){var videoContainer=jQuery('.shortcode-video');var videoTitle=videoContainer.attr('vid-name');var videoURL=jQuery('.shortcode-video').attr('vid-url');var videoCat=videoContainer.attr('vid-cat');var videoDate=videoContainer.attr('vid-date');var vidId=videoContainer.attr('vid-id');var vidImage=videoContainer.attr('vid-image');var video25sent=false;var video50sent=false;var video75sent=false;var playerInstance=jwplayer('myVidShortcode');var jwvidcon=document.querySelector('.shortcode-video');var adObject='';var adUrl=GetArticleMediaCenterAdURL();if(typeof(digitalData)!=='undefined'&&typeof(adUpgrade)==='undefined'){digitalData.videoName=videoCat+' - '+ videoTitle;digitalData.videoCategory=videoCat;digitalData.videoPublishDate=videoDate;}
adObject={client:'googima',tag:adUrl,};playerInstance.setup({file:videoURL,width:'100%',aspectratio:'16:9',skin:'bekle',advertising:adObject,autostart:autoStartVid,image:vidImage,visualplaylist:false,repeat:'false',}).on('play',function(event){window.videosClickable=true;}).on('firstFrame',function(e){video25sent=false;video50sent=false;video75sent=false;try{_satellite.track('videostart');}catch(d){console.log('DTM Error');}}).on('ready',function(){var playerContainer=jQuery('.video-player-container');var playerContainerEl=document.querySelector('.video-player-container ');var utils=playerInstance.utils;var playerHeight=jQuery('.video-player-container video').height();playerContainer.show();var playerOffsetTop=getElementOffsetTop(playerContainerEl);playerContainer.css({'height':playerHeight+'px','display':'block'});function onScrollViewHandler(){var minimize=getScrollTop()>=playerOffsetTop;utils.toggleClass(jwvidcon,'player-minimize',minimize);if(getScrollTop()<=playerOffsetTop){jQuery('.shortcode-video').removeClass('revert-minivid');}
playerInstance.resize();}
var isScrollTimeout=false;window.onscroll=function(){if(isScrollTimeout){return;}
isScrollTimeout=true;onScrollViewHandler();setTimeout(function(){isScrollTimeout=false;},80);};}).on('time',function(e){try{if(!video25sent&&(playerInstance.getPosition()/ playerInstance.getDuration())>0.25){video25sent=true;_satellite.track('video25');jQuery.post(ajaxurl,{'action':'add_vid_to_watched_cookie','cvid':vidId,'nonce':'ibd-video-watched-cookie',},function(response){console.log('vid: '+ response);});}
if(!video50sent&&(playerInstance.getPosition()/ playerInstance.getDuration())>0.5){video50sent=true;_satellite.track('video50');}
if(!video75sent&&(playerInstance.getPosition()/ playerInstance.getDuration())>0.75){video75sent=true;_satellite.track('video75');}}catch(d){console.log('DTM Error: '+ d);}}).on('beforeComplete',function(event){try{_satellite.track('videocomplete');}catch(e){console.log('DTM Error');}
var viewTime=playerInstance.getPosition();var pauseUrl=jQuery(this).data('vid-end');viewTime=Math.round(viewTime);if(pauseUrl){pauseUrl=pauseUrl.replace('[time]',viewTime);var img=jQuery('<img id=\"vidpause-pixel\">');img.attr('src',pauseUrl);img.appendTo('body');}}).on('mute',function(e){_satellite.track('mute');}).on('pause',function(e){_satellite.track('pause');var viewTime=playerInstance.getPosition();console.log('viewTime');console.log(viewTime);viewTime=Math.round(viewTime);});}},2000));});